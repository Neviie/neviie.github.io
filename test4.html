
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no">
		<manifest="android:windowSoftInputMode="adjustPan">
		<title>proezdnoy</title>
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
		<script src="https://telegram.org/js/telegram-web-app.js"></script>
		<script src="https://puzzlebot.top/webapp.js"></script>
		<link rel="stylesheet" href="https://neviie.github.io/StyleN.css">
	</head>
<body>
<script>
	let tg = window.Telegram.WebApp; 
	const userId = tg.initDataUnsafe.user.id;
    const url = 'https://cp.puzzlebot.top/api?token=2s1OVLz5iHnPeU7dp8ZGAUrFww8cQ4p9&method=getVariableValue&variable=custom_variable_JHCW5J5N0KX6CBUG&user_id=';
    const proxyUrl = 'https://api.allorigins.win/raw?url=';
	const fullUrl = (url + userId);
    const UstUrl = 'https://cp.puzzlebot.top/api?token=2s1OVLz5iHnPeU7dp8ZGAUrFww8cQ4p9&method=getVariableValue&variable=custom_variable_IY2WMO6EZ6G64HDH&user_id=';
	const fullUstUrl = (UstUrl + userId);
	const fakeParam = Date.now(); // создание фиктивного параметра с текущим временем в миллисекундах
	
	fetch(`${proxyUrl}${encodeURIComponent(fullUrl)}&fake_param=${fakeParam}`)
      .then(response => response.json())
      .then(data => {
        // Обновляем содержимое элемента с идентификатором "result"
        document.getElementById('result').innerHTML = data.data;
		document.getElementById('result2').innerHTML = data.data;
      })
      .catch(error => console.error(error));
	  
	  fetch(`${proxyUrl}${encodeURIComponent(fullUstUrl)}&fake_param=${fakeParam}`)
      .then(response => response.json())
      .then(data => {
        // Обновляем содержимое элемента с идентификатором "result"
        document.getElementById('ustr').innerHTML = data.data;
      })
      .catch(error => console.error(error));
	  
	  
		const timeurl = 'https://cp.puzzlebot.top/api?token=2s1OVLz5iHnPeU7dp8ZGAUrFww8cQ4p9&method=getVariableValue&variable=custom_variable_EQUMN64C802ABNQD&user_id=';
		const timefullUrl = (timeurl + userId);
		
		fetch(`${proxyUrl}${encodeURIComponent(timefullUrl)}&fake_param=${fakeParam}`)
		  .then(response => response.json())
		  .then(data => {
			// Обновляем содержимое элемента с идентификатором "result"
			document.getElementById('current_date_time_block').innerHTML = data.data;
		  })
		  .catch(error => console.error(error));
		  
		
		fetch(`${proxyUrl}${encodeURIComponent(timefullUrl)}&fake_param=${fakeParam}`)
		  .then(response => response.json())
		  .then(data => {
			// Получаем текущую дату
			const currentDate = new Date();
			// Форматируем дату в строку в нужном формате
			const formattedDay = currentDate.getDate().toString().padStart(2, '0');
			const formattedMonth = (currentDate.getMonth() + 1).toString().padStart(2, '0');
			const formattedYear = currentDate.getFullYear().toString();
			const formattedDate = `${formattedDay}.${formattedMonth}.${formattedYear} `;
			// Обновляем содержимое элемента с идентификатором "current_date_time_block"
			document.getElementById('x').innerHTML = `${formattedDate} ${data.data}`;
		  })
		  .catch(error => console.error(error));
  </script>
<div class="shap">
</div>
<div class="shap_x">	
	<div class="mini_line"></div>
	<div class="mini_line2"></div>
	<div class="mini_line2"></div>
	<div class="shap_cen"><op>Оплата проезда</op> <div class="null_shap"></div> <zo>Заказ оплачен</zo></div>
</div>
<div class="marshrut">
	<div class="text_t_p">
		<mar>Маршрут №<kal>2</kal></mar>
		<div class="null_marsh"></div>
		<mar>Трамвай <div class="inp_avt" style = "display:inline-block;" id = "result"></div></mar>
		<div class="null_marsh"></div>
		<mar>Оплачено <kal>33 руб</kal></mar>
		<div class="null_marsh"></div>
		<mar>пассажиров <kal>1</kal> багажа <kal>0</kal></mar>
		<div class="null_marsh"></div>
		<ust>Устройство</ust> 			<!--нужно подсосать устройство если возможно-->
		<div class="null_marsh"></div>
		<pixel> <div class="inp_ust" id="ustr"style = "display:inline-block;"></div></pixel>
	</div>
</div>
<div class="time_pos">
	<div class="text_t_p">
		<t>Время посадки</t>
		<div class="null_pos"></div>
		<x><div id="current_date_time_block"></div></x>
		
		<div class="null_pos"></div>
		<y><div id="current_date_time_blockk"></div>

		<script type="text/javascript">
    
		/* функция добавления ведущих нулей */
		/* (если число меньше десяти, перед числом добавляем ноль) */
		function zero_first_format(value)
		{
			if (value < 10)
			{
				value='0'+value;
			}
			return value;
		}

		function date_time()
		{
			var current_datetime = new Date();
			var day = zero_first_format(current_datetime.getDate());
			var month = zero_first_format(current_datetime.getMonth()+1);
			var year = current_datetime.getFullYear();
			var hours = zero_first_format(current_datetime.getHours());
			var minutes = zero_first_format(current_datetime.getMinutes());
			var seconds = zero_first_format(current_datetime.getSeconds());

			return  day+"."+month+"."+year;
		}

		/* выводим текущую дату и время на сайт в блок с id "current_date_time_block" */
		document.getElementById('current_date_time_blockk').innerHTML = date_time();
		</script></y>
	</div>
</div>
<div class="timer">
	<div class="text_t_p">
		<t>Время в пути</t>
		<div class="null_pos"></div>
		<timere><div id="timer" style="color: white">00:00</div><timere>
	<script>
			var timerElement = document.getElementById("timer");
var startDate;

// Получаем дату из API при загрузке страницы
function fetchStartDate() {
  let tg = window.Telegram.WebApp;
  const userId = tg.initDataUnsafe.user.id;
  const url = 'https://cp.puzzlebot.top/api?token=2s1OVLz5iHnPeU7dp8ZGAUrFww8cQ4p9&method=getVariableValue&variable=custom_variable_4BR7NHAOB92588S5&user_id=';
  const proxyUrl = 'https://api.allorigins.win/raw?url=';
  const fullUrl = (url + userId);
  const fakeParam = Date.now(); // создание фиктивного параметра с текущим временем в миллисекундах

  fetch(`${proxyUrl}${encodeURIComponent(fullUrl)}&fake_param=${fakeParam}`)
    .then(response => response.json())
    .then(data => {
      // Создаем объект Date из полученного значения
      startDate = new Date(data.data * 1000);
      
      // Обновляем таймер сразу после получения даты
      updateTimer();
      
      // Обновляем таймер каждую секунду после получения даты
      setInterval(updateTimer, 1000);
    })
    .catch(error => console.log(error));
}

// Функция для обновления секундомера
function updateTimer() {
  // Вычисляем разницу между текущей датой и начальной датой
  var diff = new Date() - startDate;
  
  // Преобразуем разницу в формат "чч:мм:сс"
  var hours = Math.floor(diff / 3600000);
  var minutes = Math.floor((diff - hours * 3600000) / 60000);
  var seconds = Math.floor((diff - hours * 3600000 - minutes * 60000) / 1000);
  var formattedTime = 
    minutes.toString().padStart(2, '0') + ':' +
    seconds.toString().padStart(2, '0');
  
  // Отображаем секундомер на странице
  timerElement.innerText = formattedTime;
}

fetchStartDate();
   </script> 
  
	</div>
</div>
<div class="qr">
	<div class="text_t_p">
	<img class="imqr" src="https://proezdnoy59.files.wordpress.com/2022/05/qr.jpg">
	</div>
</div>
<div class="ost">
	<div class="text_t_p">
	<ust>Остаток баланса 33 руб</ust>
	</div>
</div>
<div class="control">
	<div class="text_t_p">
	<pixel>КОНТРОЛЬНЫЙ БИЛЕТ</pixel>
	<div class="null_cont"></div>
	<n>№<div style="display:inline-block;" id="e"></div>
<script type="text/javascript">
function getRandomInt(min, max) {
  return Math.floor(Math.random() * (max - min)) + min;
}

document.getElementById('e').innerHTML = getRandomInt(5000000000, 9000000000)
</script></n>							<!--генератор случайных 10 значных чисел-->
	<div class="null_cont2"></div>
	<n><div id="x"></div></n>							<!--нужно подсосать время-->
	<div class="null_cont2"></div>
		<div class="line">
		</div>
	<div class="null_cont3"></div>
	<n>ИП Златовская Т.А.</n>
	<div class="null_cont"></div>
	<n>ИНН 590406162035</n>	
	<div class="null_cont"></div>
	<n>по заказу МКУ "Гортранс"</n>	
	<div class="null_cont"></div>
		<div class="line">
		</div>
	<div class="null_cont3"></div>
	
	<div class="marshrut_dviz"><marshrutfont>2, Станция Осенцы - Стахановское</marshrutfont></div>			<!--сделать в две строки-->
	<div class="marshrut_dviz"><marshrutfont>кольцо</marshrutfont></div>
	
	<div class="null_cont3"></div>
	<n>Трамвай</n><div style="display:inline-block;" id="result2" class="inp_avt2"></div>
		<div class="null_cont"></div>
		<div class="line"></div>
	<div class="null_cont3"></div>
	<kim>Стоимость: 33 руб</kim>
	</div>
</div>
<div class="null_cont3""></div>
<div class="bottom">

</div>
<div class="bottom_x">
	<figure class="fig_1">
	<img src="ticketN.png" img class="img_fig_1">
	<figcaption class="font_fig_1">Билеты</figcaption>
	</figure>
	<figure class="fig_2">
	<img src="tabletN.png" class="img_fig_2">
	<figcaption class="font_fig_2">Проездной</figcaption>
	</figure>
	<figure class="fig_3">
	<img src="profileN.png" class="img_fig_3">
	<figcaption class="font_fig_3">Кабинет</figcaption>
	</figure>
	<figure class="fig_4">
	<img src="busN.png" img class="img_fig_4">
	<figcaption class="font_fig_4">Расписание</figcaption>
	</figure>
</div>
</body>
</html>
